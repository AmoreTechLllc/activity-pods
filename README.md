[![SemApps](https://badgen.net/badge/Powered%20by/SemApps/28CDFB)](https://semapps.org)

![activitypods-small](https://user-images.githubusercontent.com/17931931/215525902-6ae72fa9-fde0-43eb-a053-0ccfd4565ead.png)

# ActivityPods

Check out [our website](https://activitypods.org) or [these slides](./docs/public/proposal/proposal-english.pdf) ([french version](./docs/public/proposal/proposal-french.pdf)) for more information about this project !

### Applications using ActivityPods

- [Mastopod](https://github.com/activitypods/mastopod)
- [Welcome To My Place](https://github.com/activitypods/welcometomyplace) ([french version](https://bienvenuechezmoi.org))
- [Mutual Aid](https://github.com/activitypods/mutual-aid.app) ([french version](https://lentraide.app))

### Pod providers

- [MyPod.store](https://mypod.store) (English)
- [Armoise.co](https://armoise.co) (French, Oise area)

## Getting started

### Launch Fuseki and Redis

```bash
cd pod-provider
make start
```

### Launch the backend

```bash
cd pod-provider/backend
yarn install
yarn run dev
```

### Launch the frontend

```bash
cd pod-provider/frontend
yarn install
yarn start
```

## Linking to SemApps packages

To modify packages on the [SemApps repository](https://github.com/assemblee-virtuelle/semapps) and see the changes before they are published on NPM, see the following instructions.

### Linking backend packages

To link backend packages, you can use [`yarn link`](https://classic.yarnpkg.com/en/docs/cli/link/).

```bash
cd /SEMAPPS_REPO/src/middleware
yarn run link-all
cd /ACTIVITYPODS_REPO/pod-provider/backend
yarn run link-semapps-packages
```

### Linking frontend packages

Linking frontend packages with `yarn link` doesn't work because it causes version mismatch errors for React and MUI (see [this PR](https://github.com/assemblee-virtuelle/semapps/pull/1180) for explainations). So you should use [Yalc](https://github.com/wclr/yalc) instead. Fortunately, we make it easy for you.

```bash
cd /SEMAPPS_REPO/src/frontend
yarn run yalc:publish
cd /ACTIVITYPODS_REPO/pod-provider/frontend
yarn run link-semapps-packages
```

Additionally, frontend packages need to be rebuilt on every changes, or they will not be taken into account by ActivityPods. You can use `yarn run build` to build a package once, or `yarn run watch` to rebuild a package on every change. On every build, the new package will be published to Yalc.

Thanks to Git hooks, the frontend packages will also be published to Yalc whenever git branches are changed.

## Maintainance

We recommend to regularly compact the datasets generated by Fuseki, otherwise they may grow very large. Unfortunately, due to the [extension we developed to handle WAC permissions](https://semapps.org/docs/triplestore), it is required to stop Fuseki, compact it and launch it again.

```bash
cd pod-provider
make compact-datasets
```

## Integration tests

See the [tests documentation](./tests/README.md).

## Funding

This project is funded through the [NGI0 Entrust Fund](https://nlnet.nl/entrust), a fund
established by [NLnet](https://nlnet.nl) with financial support from the European Commission's
[Next Generation Internet](https://ngi.eu) program, under the aegis of DG Communications Networks,
Content and Technology under grant agreement No 101069594. Learn more on the [NLnet project page](https://nlnet.nl/project/ActivityPods).

[<img src="https://nlnet.nl/logo/banner.png" alt="NLNet foundation logo" width="300" />](https://nlnet.nl/)
[<img src="https://nlnet.nl/image/logos/NGI0Entrust_tag.svg" alt="NGI Zero Entrust Logo" width="300" />](https://nlnet.nl/)
